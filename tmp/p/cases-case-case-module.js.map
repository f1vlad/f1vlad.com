{"version":3,"sources":["webpack:///./src/app/cases/case/case.module.ts","webpack:///./src/app/cases/case/case.page.html","webpack:///./src/app/cases/case/case.page.scss","webpack:///./src/app/cases/case/case.page.ts"],"names":[],"mappings":"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","file":"cases-case-case-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { Routes, RouterModule } from '@angular/router';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { CasePage } from './case.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CasePage\n  }\n];\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    RouterModule.forChild(routes)\n  ],\n  declarations: [CasePage]\n})\nexport class CasePageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar translucent=\\\"true\\\">\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-back-button defaultHref=\\\"/\\\" [text]=\\\"backButtonText\\\"></ion-back-button>\\n    </ion-buttons>\\n    <ion-item lines=\\\"none\\\" color=\\\"transparent\\\">\\n      <ion-label>\\n        <ion-skeleton-text *ngIf=\\\"!data\\\" animated style=\\\"width: 60%\\\"></ion-skeleton-text>\\n        <span *ngIf=\\\"data\\\">{{ data.name }}</span>\\n      </ion-label>\\n    </ion-item>\\n    <ion-buttons *ngIf=\\\"data\\\" slot=\\\"primary\\\">\\n      <ion-button [hidden]=\\\"data.isOwner===false\\\" (click)=\\\"presentPopover()\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"share\\\"></ion-icon>\\n      </ion-button>\\n    </ion-buttons>\\n  </ion-toolbar>\\n</ion-header>\\n\\n<ion-content fullscreen=\\\"true\\\">\\n  <span *ngIf=\\\"data\\\">\\n    <ion-card>\\n      <ion-card-header>\\n        <ion-card-subtitle>Case #{{ data.number }}</ion-card-subtitle>\\n      </ion-card-header>\\n      <!-- TODO \\n        ion-row/col should be inside single ion-grid\\n      -->\\n      <ion-grid>\\n        <ion-row *ngIf=\\\"data.isShared === true\\\">\\n          <ion-col size=\\\"4\\\">\\n            <div>Shared by</div>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <div>{{data.creatorEmail}}</div>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <div>Created</div>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <div>{{ relativeTimeCreated }}</div>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <div>Updated</div>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <div>{{ relativeTimeUpdated }}</div>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <div>Notes</div>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <div>{{ data.notes }}</div>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <div [hidden]=\\\"data.isOwner===false\\\">Shared with</div>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\" *ngIf=\\\"data?.shares\\\">\\n            <span *ngFor=\\\"let share of data.shares\\\">\\n              <ion-badge (click)=\\\"presentPopoverCaseSharedWith($event, share)\\\">\\n                <ion-icon name=\\\"person\\\"></ion-icon>\\n                {{ share.userInitials }}\\n              </ion-badge>\\n            </span>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row *ngIf=\\\"data?.saves.length > 0\\\" >\\n          <ion-col>\\n            <div>Addresses</div>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col>\\n            <ng-container\\n              *ngFor=\\\"let save of data.saves\\\"\\n            >\\n              <ion-badge\\n                *ngIf=\\\"!save.saveType.includes('_tx')\\\"\\n                [routerLink]=\\\"['/trace/'+configureEndpointRoute(save.saveType), save.address]\\\"\\n                text-wrap\\n              >\\n                <span *ngIf=\\\"save.saveType !== 'transaction'\\\">\\n                  <ion-icon name=\\\"wallet\\\"></ion-icon>\\n                  {{ save.address }}\\n                  <ng-container *ngIf=\\\"save.notes\\\">\\n                    ({{ save.notes }})\\n                  </ng-container>\\n                </span>\\n              </ion-badge>\\n            </ng-container>\\n          </ion-col>\\n        </ion-row>\\n      </ion-grid>\\n    </ion-card>\\n  </span>\\n\\n  <span *ngIf=\\\"!data\\\">\\n    <ion-card>\\n      <ion-grid>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <ion-skeleton-text animated style=\\\"width: 40px\\\"></ion-skeleton-text>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <ion-skeleton-text animated style=\\\"width: 60px\\\"></ion-skeleton-text>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <ion-skeleton-text animated style=\\\"width: 30px\\\"></ion-skeleton-text>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <div>\\n              <ion-skeleton-text animated style=\\\"width: 70px\\\"></ion-skeleton-text>\\n            </div>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <ion-skeleton-text animated style=\\\"width: 50px\\\"></ion-skeleton-text>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <ion-skeleton-text animated style=\\\"width: 70px\\\"></ion-skeleton-text>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <ion-skeleton-text animated style=\\\"width: 40px\\\"></ion-skeleton-text>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <ion-skeleton-text animated style=\\\"width: 100%\\\"></ion-skeleton-text>\\n            <ion-skeleton-text animated style=\\\"width: 100%\\\"></ion-skeleton-text>\\n            <ion-skeleton-text animated style=\\\"width: 30%\\\"></ion-skeleton-text>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <ion-skeleton-text animated style=\\\"width: 40px\\\"></ion-skeleton-text>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <ion-skeleton-text animated style=\\\"width: 20px; display: inline-block;\\\"></ion-skeleton-text>&nbsp;&nbsp;\\n            <ion-skeleton-text animated style=\\\"width: 20px; display: inline-block;\\\"></ion-skeleton-text>\\n          </ion-col>\\n        </ion-row>\\n        <ion-row>\\n          <ion-col size=\\\"4\\\">\\n            <ion-skeleton-text animated style=\\\"width: 46px\\\"></ion-skeleton-text>\\n          </ion-col>\\n          <ion-col size=\\\"8\\\">\\n            <ion-skeleton-text animated style=\\\"width: 100%\\\"></ion-skeleton-text>\\n            <ion-skeleton-text animated style=\\\"width: 15%\\\"></ion-skeleton-text>\\n          </ion-col>\\n        </ion-row>\\n      </ion-grid>\\n    </ion-card>\\n  </span>\\n</ion-content>\\n\"","module.exports = \"ion-button[disabled] {\\n  display: none; }\\n\\nion-badge {\\n  background: var(--ion-color-primary-tint);\\n  color: --ion-color-primary-contrast;\\n  font-size: inherit;\\n  word-break: break-all;\\n  margin-bottom: .5rem;\\n  margin-right: .25rem; }\\n\\nion-label {\\n  color: var(--ion-color-step-600, #666) !important; }\\n\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9mMXZsYWRjdG1iL2dpdC9DaXBoZXJUcmFjZUZpZWxkQXBwL3NyYy9hcHAvY2FzZXMvY2FzZS9jYXNlLnBhZ2Uuc2NzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNJLGFBQWEsRUFBQTs7QUFHakI7RUFDSSx5Q0FBeUM7RUFDekMsbUNBQW1DO0VBQ25DLGtCQUFrQjtFQUNsQixxQkFBcUI7RUFDckIsb0JBQW9CO0VBQ3BCLG9CQUFvQixFQUFBOztBQUd4QjtFQUNJLGlEQUFnRCxFQUFBIiwiZmlsZSI6InNyYy9hcHAvY2FzZXMvY2FzZS9jYXNlLnBhZ2Uuc2NzcyIsInNvdXJjZXNDb250ZW50IjpbImlvbi1idXR0b25bZGlzYWJsZWRdIHtcbiAgICBkaXNwbGF5OiBub25lO1xufVxuXG5pb24tYmFkZ2Uge1xuICAgIGJhY2tncm91bmQ6IHZhcigtLWlvbi1jb2xvci1wcmltYXJ5LXRpbnQpO1xuICAgIGNvbG9yOiAtLWlvbi1jb2xvci1wcmltYXJ5LWNvbnRyYXN0O1xuICAgIGZvbnQtc2l6ZTogaW5oZXJpdDtcbiAgICB3b3JkLWJyZWFrOiBicmVhay1hbGw7XG4gICAgbWFyZ2luLWJvdHRvbTogLjVyZW07XG4gICAgbWFyZ2luLXJpZ2h0OiAuMjVyZW07XG59XG5cbmlvbi1sYWJlbCB7XG4gICAgY29sb3I6IHZhcigtLWlvbi1jb2xvci1zdGVwLTYwMCwjNjY2KSAhaW1wb3J0YW50O1xufVxuIl19 */\"","import { Component, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { CaseService } from 'src/app/services/case.service';\nimport { ShareService } from 'src/app/services/share.service';\nimport { Case } from 'src/app/models/case';\nimport { FormBuilder, FormGroup, Validators, AbstractControl, ReactiveFormsModule } from '@angular/forms';\nimport { ShareViaEmailComponent } from '../../components/share-via-email/share-via-email.component';\nimport { SharedWithInfoComponent } from '../../components/shared-with-info/shared-with-info.component';\nimport { ModalController } from '@ionic/angular';\nimport { PopoverController } from '@ionic/angular';\nimport * as moment from 'moment';\nimport _has from 'lodash/get';\n\n@Component({\n  selector: 'app-case',\n  templateUrl: './case.page.html',\n  styleUrls: ['./case.page.scss'],\n})\nexport class CasePage implements OnInit {\n  hash: string;\n  data: Case;\n  backButtonText = '';\n  relativeTimeCreated: string;\n  relativeTimeUpdated: string;\n\n  // shareCaseFormGroup: FormGroup;\n  // email: AbstractControl;\n\n  // tmp dev\n  caseName: string;\n  caseNotes: string;\n\n  constructor(\n    private activatedRoute: ActivatedRoute,\n    private caseService: CaseService,\n    private shareService: ShareService,\n    private formBuilder: FormBuilder,\n    public modalController: ModalController,\n    public popoverController: PopoverController\n  ) {\n    // this.shareCaseFormGroup = formBuilder.group({\n    //   email: ['', Validators.compose(\n    //       [Validators.required, Validators.email]\n    //     )\n    //   ]\n    // });\n    // this.email = this.shareCaseFormGroup.controls['email'];\n  }\n\n  ngOnInit() {\n    this.activatedRoute.paramMap.subscribe(paramMap => {\n      if(!paramMap.has('hash')) {\n        return;\n      }\n\n      this.hash = paramMap.get('hash');\n\n      this.fetchCase();\n    });\n  }\n\n  fetchCase() {\n    this.caseService.fetchCase(this.hash).toPromise().then(res => {\n      this.data = res;\n      this.relativeTimeCreated = moment(res.createdDate * 1000).fromNow();\n      this.relativeTimeUpdated = moment(res.updatedDate * 1000).fromNow();\n    });\n  }\n\n  async presentModal() {\n    const modal = await this.modalController.create({\n      component: ShareViaEmailComponent\n    });\n    return await modal.present();\n  }\n\n  async presentPopover(ev: any) {\n    const popover = await this.popoverController.create({\n      component: ShareViaEmailComponent,\n      componentProps: {\n        caseId: this.data.caseId\n      },\n      event: ev,\n      translucent: true\n    });\n\n    popover.onDidDismiss().then(data => {\n      if(_has(data, 'data')) {\n        this.fetchCase();\n      }\n    })\n\n    return await popover.present();\n  }\n\n  async presentPopoverCaseSharedWith(ev: any, details: any) {\n    const popover = await this.popoverController.create({\n      component: SharedWithInfoComponent,\n      componentProps: {\n        // TODO render this as HTML\n        // info: `<span style=\"background: ${details.userColor}\">${details.userInitials}</span> <a href=\"mailto:${details.userEmail}\">${details.userEmail}</a>`\n        info: `${details.userInitials} — ${details!.userEmail}`\n      },\n      event: ev,\n      translucent: true\n    });\n\n    return await popover.present();\n  }\n\n  configureEndpointRoute(saveType) {\n    // ENG-507\n    // This is a hack to support legacy cases which have imported addresses\n    // with wrong saveType, for legacy cases we're assuming they're tracking\n    // BTC and fixing endpoint request accordingly.\n    if(saveType === 'address') {\n      return 'btc';\n    }\n\n    return saveType.replace('_addr', '');\n  }\n\n\n  // onShareCase(email) {\n  //   this.shareService.shareCase(this.hash, email).toPromise().then(res => {\n  //     console.log(res);\n\n  //     // do a secondary call here to get metadata about users with whom case was shared\n  //     this.shareService.getCaseShareMetadata(this.hash).toPromise().then(res => {\n  //       console.log(`second post-share call ` + res);\n  //     });\n\n  //     return res;\n  //   })\n  // }\n\n}\n"],"sourceRoot":""}